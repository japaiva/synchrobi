<!-- gestor/templates/gestor/empresa_centro_custo_delete.html -->
{% extends 'gestor/base_gestor.html' %}

{% block title %}Excluir Relacionamento | SynchroBI{% endblock %}

{% block content %}
<div class="card shadow">
  <div class="card-header bg-light d-flex justify-content-between align-items-center">
    <h5 class="card-title mb-0">
      <i class="fas fa-trash-alt me-2 text-danger"></i>
      Excluir Relacionamento
    </h5>
    <a href="{% url 'gestor:empresa_centro_custo_list' %}" 
       class="btn btn-outline-secondary btn-sm">
      <i class="fas fa-arrow-left me-1"></i> Voltar
    </a>
  </div>
  
  <div class="card-body">
    <div class="alert alert-danger">
      <i class="fas fa-exclamation-triangle me-2"></i>
      <strong>Atenção!</strong> Esta ação não pode ser desfeita.
    </div>

    <div class="card shadow-sm mb-4">
      <div class="card-header bg-light">
        <h6 class="card-title mb-0">
          <i class="fas fa-info-circle me-2"></i>
          Dados do Relacionamento
        </h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label fw-bold">Empresa:</label>
              <div class="bg-light p-2 rounded">
                <div class="fw-bold">{{ relacionamento.empresa.sigla }}</div>
                <div class="small text-muted">{{ relacionamento.empresa.razao_social }}</div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label fw-bold">Centro de Custo:</label>
              <div class="bg-light p-2 rounded">
                <div class="fw-bold">{{ relacionamento.centro_custo.codigo }}</div>
                <div class="small text-muted">{{ relacionamento.centro_custo.nome }}</div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label fw-bold">Responsável:</label>
              <div class="bg-light p-2 rounded">
                <div class="fw-bold">{{ relacionamento.responsavel.first_name }} {{ relacionamento.responsavel.last_name }}</div>
                <div class="small text-muted">{{ relacionamento.responsavel.email }}</div>
              </div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label fw-bold">Status:</label>
              <div class="bg-light p-2 rounded">
                {% if relacionamento.ativo %}
                  <span class="badge bg-success">Ativo</span>
                {% else %}
                  <span class="badge bg-secondary">Inativo</span>
                {% endif %}
              </div>
            </div>
          </div>
          
          {% if relacionamento.observacoes %}
          <div class="col-md-12">
            <div class="mb-3">
              <label class="form-label fw-bold">Observações:</label>
              <div class="bg-light p-2 rounded">
                {{ relacionamento.observacoes }}
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>


    <form method="post" class="d-flex justify-content-between align-items-center">
      {% csrf_token %}
      
      <div>
        <a href="{% url 'gestor:empresa_centro_custo_list' %}" 
           class="btn btn-outline-secondary me-2">
          <i class="fas fa-times me-1"></i> Cancelar
        </a>
      </div>
      
      <div>
        <button type="submit" class="btn btn-danger">
          <i class="fas fa-trash-alt me-1"></i> 
          Confirmar Exclusão
        </button>
      </div>
    </form>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Confirmação adicional antes de submeter
    const form = document.querySelector('form[method="post"]');
    const submitBtn = form.querySelector('button[type="submit"]');
    
    form.addEventListener('submit', function(e) {
        const confirmText = 'Tem certeza que deseja excluir este relacionamento?\n\n' +
                          'Empresa: {{ relacionamento.empresa.sigla }}\n' +
                          'Centro de Custo: {{ relacionamento.centro_custo.codigo }}\n\n' +
                          'Esta ação NÃO pode ser desfeita!';
        
        if (!confirm(confirmText)) {
            e.preventDefault();
        }
    });
    
    // Efeito visual no botão
    submitBtn.addEventListener('mouseenter', function() {
        this.innerHTML = '<i class="fas fa-exclamation-triangle me-1"></i> EXCLUIR PERMANENTEMENTE';
    });
    
    submitBtn.addEventListener('mouseleave', function() {
        this.innerHTML = '<i class="fas fa-trash-alt me-1"></i> Confirmar Exclusão';
    });
});
</script>

<style>
.btn-danger:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
}

.card-header.bg-warning {
    border-left: 4px solid #ffc107;
}

.alert-danger {
    border-left: 4px solid #dc3545;
}
</style>
{% endblock %}